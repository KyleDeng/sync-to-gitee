name: Sync to Gitee

on:
  push:
    branches:
      - master  # 只同步master分支

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout source code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # 获取完整的提交历史

      - name: Setup SSH key
        uses: webfactory/ssh-agent@v0.8.0
        with:
          ssh-private-key: ${{ secrets.GITEE_PRIVATE_KEY }}

      - name: Add Gitee remote
        run: |
          # 添加 Gitee 主机密钥到 known_hosts
          mkdir -p ~/.ssh
          echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCnL+KPRFxw3c15cX2VwS6qN2KQk8m3jVh7B6X5H6Dq+h5K2v2f8JZJ5mQjZ6J8X9K7v9D5v5D2n2c5b8r0bQ1n4c8W4y4T8Z4g8p2n3L2L0r5e4T5W3i0W1t8p5E8c3O0O0k2J5J6n1W2J0H6c4d2n3V2b8K5J2K2d4a6D7K1N4m2S5r2H1G0e3N2O7j7J4J1N1K6A2A1m2W4c3W2v4t6p3H2N3o4d0c3J5E5A5J0J6a2W0L1n6Z4K5J4t1J2v2a0m1O3K0d4S4L4a1P1c2V0h3c3M1m0R1N5L6l0O0W4u2S6N2a2V5V1S3G1p0C0W2d0G1S0i3S0r2E4i4d0O2v3M3q0J1Z4A0a3A1J4N5M0L4V3J0G4W1a1t2R4K6P0D2r3V3p2X1F3V1f5C0L1D3n0a3N2Y2b1J0V1Z3S1v3Q5d0K3c2L4c3a4t2C3l4Z5K2M3Z1X0V1E2J0Y3L0a2T3V0G5h4P4c3G3W1H3h3E3L3S4D2j1A0b1S3Q1n0F4T3L2C3B3d2N3W0T3c0V1p4Y3k3T2v2R3a3Z1S4c1H4W0N0p1Z2V3a3Z4F4h3B0K0v0V1d1Z1k1W0V3c1P0N0J3J2F2n0B2v0B2J2c1S1C3a3V2h3O2T1W0m1F2f2T0m1Y1r2O3e2D0L1V3H2p2W3t0W2d3T1a1W4c0N1a1L3t1Z3A1Z0W1q0S3D2r2P0K1J3X0d2Q1D0a1N4e0V3W0V0m1B1H1c2G1J1H3Z2a3A2E0L0W3A3L2H2T2k2G2e2I0c0a3G0O0h3M0C2E2d1T3P2m0A2S2k2V2B2d2K0m1D0f3G1K2v3O2Z1a1Z3F1L1D2k2U2G2d2W0v1B0D0N0m2T1S1M0H2B2i1Y1d0W3r1E1S2n2S0V2K0O2P0E0O3T1J0X0d0G0O1m1T0I1L1S0S0r0B1c0F1E0v0I0a0Y0o0P0a0k0i0y0p0h0c0o0d0e0gitee.com" >> ~/.ssh/known_hosts
          # 设置 Git 身份
          git config --global user.name "GitHub Action"  # 保留，不需要修改
          git config --global user.email "action@github.com"  # 保留，不需要改
          # 添加 Gitee 远程仓库
          git remote add gitee ${{ secrets.GITEE_REPO }}

      - name: Push to Gitee
        run: git push gitee master --force    
